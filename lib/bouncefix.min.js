/*!
 * v0.0.3
 * Copyright (c) 2013 Jarid Margolin
 * bouncefix.js is open sourced under the MIT license.
 */
!function(a){function b(a){return a?(this.el=a,this.startListener=new c(this.el,{evt:"touchstart",handler:this._scrollToEnd,context:this}),this.moveListener=new c(this.el,{evt:"touchmove",handler:function(a){a.preventDefault()}}),this.observer=this._addObserver(),this._manageState(),void 0):!1}function c(a,b){this.evt=b.evt,this.el=a,this.handler=b.handler,b.context&&(this.handler=function(a){b.handler.call(b.context,a)})}var d={BounceFix:b,fixCache:[],elCache:[]};d.add=function(a){return this.elCache.indexOf(a)<0&&(this.elCache.push(a),this.fixCache.push(new b(a))),this.fixCache[this.fixCache.length-1]},d.remove=function(a){var b=this.elCache.indexOf(a);b>=0&&(this.fixCache[b].remove(),this.elCache.splice(b,1),this.fixCache.splice(b,1))},b.prototype._addObserver=function(){var a=this,b=new MutationObserver(function(b){a._manageState(b)});return b.observe(el,{childList:!0,attributes:!0,subtree:!0}),b},b.prototype._manageState=function(){return this.el.scrollHeight>this.el.offsetHeight?this._enable():this._disable()},b.prototype._scrollToEnd=function(){var a=this.el.scrollTop,b=this.el.offsetHeight,c=this.el.scrollHeight;0>=a&&(this.el.scrollTop=1),a+b>=c&&(this.el.scrollTop=c-b-1)},b.prototype._enable=function(){this.enabled||(this.startListener.add(),this.moveListener.remove(),this.enabled=!0)},b.prototype._disable=function(){("undefined"==typeof this.enabled||this.enabled)&&(this.startListener.remove(),this.moveListener.add(),this.enabled=!1)},b.prototype.remove=function(){this.startListener.remove(),this.moveListener.remove(),this.observer.disconnect()},c.prototype.add=function(){this.el.addEventListener(this.evt,this.handler,!1)},c.prototype.remove=function(){this.el.removeEventListener(this.evt,this.handler)},"undefined"!=typeof a&&(a.bouncefix=d)}(window,document);